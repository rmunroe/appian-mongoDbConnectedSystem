version '1.0'

apply plugin: 'java'

repositories {
    mavenCentral()
}

dependencies {
    compileOnly 'com.appian:connected-systems-core:1.2.0'
    implementation 'com.appian:connected-systems-client:1.1.0'
    testImplementation 'com.appian:connected-systems-core:1.2.0'

    compileOnly group: 'log4j', name: 'log4j', version: '1.2.17'
    compileOnly group: 'commons-lang', name: 'commons-lang', version: '2.4'

    compile group: 'com.google.code.gson', name: 'gson', version: '2.8.5'
    compile group: 'org.mongodb', name: 'mongodb-driver-sync', version: '3.12.5'

    def withoutSlf4j = { exclude group: 'org.slf4j', module: 'slf4j-api' }
    compile 'org.mongodb:mongodb-crypt:1.0.1', withoutSlf4j
}


jar {
    duplicatesStrategy = DuplicatesStrategy.FAIL
    into('META-INF/lib') {
        from(configurations.runtimeClasspath)
    }

    manifest {
        attributes("Spring-Context": "*;publish-context:=false")
    }
}


task install(type: Copy) {
    dependsOn jar
    group = 'install'
    from 'build/libs/'
    into '/Users/rob.munroe/Development/Appian Plugins/plugins'
}
